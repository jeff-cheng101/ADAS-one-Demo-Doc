# Dify cloudflare 一鍵封鎖IP功能 API 接口

## POST: https://twister5.phison.com/dify/v1/workflows/run
- 增設 cloudflare 黑名單功能API
- api-key: app-7s1wJrXbAlq4EbQOwAYJxhtp

## POST: https://twister5poc.phison.com/dify/v1/workflows/run
- 增設 cloudflare 黑名單功能API
- api-key: app-Bqj7kFvMKp2SiVD7PUnH0pcL

### Requirements

|Attribute|Type|Required|Description|
|---|---|---|---|
|Authorization|String|N|值：Bearer app-7s1wJrXbAlq4EbQOwAYJxhtp (dify產出的api與api-key為1對1的關係)|

- 備註：dify 是用 api-key來對應呼叫那個api接口

### Parameter fields

|Attribute|Type|Required|Description|
|---|---|---|---|
|IPlist|String|Y|輸入分析報告內容|
|response_mode|String|N|固定:blocking|
|user|String|N|dify帳號, 固定:twister5@gmail.com|



### Example ALL skip Parameter
```json
{
  "inputs": {
    "IPlist": "WAF 檢測到大量 BotScore 低於 30 或 BotTags 包含 'malicious' 的流量，表明存在惡意機器人流量攻擊。這些流量主要來自台灣 (tw) 和美國 (us) 的 IP 地址，對 api2.twister5.cf 資產造成了高額影響。  這些流量可能用於進行無效請求攻擊、資源消耗或分散對目標網站的攻擊。\",\"aiInsight\": \"AI 深度分析：WAF 檢測到 32 次惡意機器人流量，平均分數為 15 (根據 BotScore 判定)。 主要來源為 202.39.33.231 (30次) 和 74.7.227.168 (1次)，  影響了 api2.twister5.cf  資產。 建議立即部署反機器人保護機制，並監控流量異常情況。\","
  },
  "response_mode": "blocking",
  "user": "twister5@gmail.com"
}
```
### Response fields

|Attribute|Type|Required|Description|
|---|---|---|---|
|task_id|String|Y||
|workflow_run_id|String|Y||
|data|object|Y||


### data fields

|Attribute|Type|Required|Description|
|---|---|---|---|
|id|String|Y||
|workflow_id|String|Y||
|status|String|Y||
|outputs|object|Y||

### outputs fields

|Attribute|Type|Required|Description|
|---|---|---|---|
|status_code|number|Y| 正常:200, 其它均為異常|
|body|String|Y| cloudflare API 回覆的內容|
|error_message|String|n||

### Example Response
```json
{
    "task_id": "fd764ac2-3d4e-40d9-9ee0-6590018a331b",
    "workflow_run_id": "84e84a31-fcd8-4ee6-b5bc-a3b4484eab7c",
    "data": {
        "id": "84e84a31-fcd8-4ee6-b5bc-a3b4484eab7c",
        "workflow_id": "c1cce9ef-be25-445a-9764-111de2e121ad",
        "status": "succeeded",
        "outputs": {
            "status_code": 200,
            "body": "{\n  \"result\": {\n    \"description\": \"\",\n    \"id\": \"92c8e0851be6450c9b09dbdcbbefd38e\",\n    \"kind\": \"zone\",\n    \"last_updated\": \"2025-12-23T01:43:28.034763Z\",\n    \"name\": \"default\",\n    \"phase\": \"http_request_firewall_custom\",\n    \"rules\": [\n      {\n        \"action\": \"block\",\n        \"action_parameters\": {\n          \"response\": {\n            \"content\": \"\<html\>\<header\>\<title\>文化部資訊安全通知網頁\</title\>\</header\>\\n\<body\>\<H2\>文化部資訊安全通知網頁\</H2\>\<br\>\\n很抱歉, 若您瀏覽網站時, 如發現如下的錯誤訊息. \<br\>\\n麻煩您將「事件編號(Ray ID)」或是將畫面擷取 , \<br\> \\n事件編號(Ray ID): \<::RAY_ID::\> \<br\>\\n寄至連絡信箱 soc@moc.gov.tw \<br\>\\n或撥02-8512-6677 WAF管理員 \<br\>\\n並且留下您的聯絡電話,以利後續聯繫. \<br\>\\n造成您的不便還請見諒, 謝謝. \<br\>\\n\\nSorry , If you find the error messages when you browing the MOC website, \<br\>\\nplease capture the screen or copy the Ray ID \<br\>\\nsend the meesgaes to the Email address : soc@moc.gov.tw \<br\>\\nor call to 02-8512-6677 \<br\>\\nThanks for your consideration for any inconvenience caused.\<br\>\\n\<p class=\\\"small\\\"\>錯誤代碼：\<strong\>403\</strong\> · 時間：\<span id=\\\"time\\\"\>\</span\>\</p\>     IP:  ::CLIENT_IP::  CF-RAY:   ::RAY_ID::  \</p\> \\n    \</section\> \\nHost : $(HOST)\<br\>\\n\\n\</body\>\</html\>\",\n            \"content_type\": \"text/html\",\n            \"status_code\": 403\n          }\n        },\n        \"description\": \"testblockabc\",\n        \"enabled\": false,\n        \"expression\": \"(http.host contains \\\"aabbcc123\\\") or (http.host contains \\\"nginx.caseyyy.site\\\")\",\n        \"id\": \"5ba1eae2d59c40718736811d96dcaa1a\",\n        \"last_updated\": \"2025-11-04T04:43:49.001141Z\",\n        \"ref\": \"5ba1eae2d59c40718736811d96dcaa1a\",\n        \"version\": \"20\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_request_sbfm\",\n            \"http_ratelimit\"\n          ]\n        },\n        \"description\": \" 117617846 (UptimeRobot - Verified bot), 33564662, 33564660\",\n        \"enabled\": true,\n        \"expression\": \"(cf.verified_bot_category eq \\\"Monitoring \& Analytics\\\") or (any(cf.bot_management.detection_ids[*] in {117617846}))\",\n        \"id\": \"3bfdab9357174a3f9d30c3de7c46e3c0\",\n        \"last_updated\": \"2025-12-03T08:15:55.135404Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"3bfdab9357174a3f9d30c3de7c46e3c0\",\n        \"version\": \"2\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"LLM protect\",\n        \"enabled\": true,\n        \"expression\": \"(cf.llm.prompt.unsafe_topic_detected)\",\n        \"id\": \"0639087582934d77b97e0f1b0d90244e\",\n        \"last_updated\": \"2025-11-06T08:30:40.954991Z\",\n        \"ref\": \"0639087582934d77b97e0f1b0d90244e\",\n        \"version\": \"21\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"testblock\",\n        \"enabled\": false,\n        \"expression\": \"(http.host eq \\\"cdweruio.win\\\" and not http.request.uri.path wildcard r\\\"/api/*\\\") or (http.host ne \\\"ssapi.cdweruio.win\\\")\",\n        \"id\": \"4b41be190b744cfeba08020196c95476\",\n        \"last_updated\": \"2025-10-09T04:39:16.354978Z\",\n        \"ref\": \"4b41be190b744cfeba08020196c95476\",\n        \"version\": \"4\"\n      },\n      {\n        \"action\": \"log\",\n        \"description\": \"log\",\n        \"enabled\": true,\n        \"expression\": \"(http.host contains \\\"twister5.cf\\\")\",\n        \"id\": \"ee448f20e7024cdda29f8ec20aa2ffd0\",\n        \"last_updated\": \"2025-05-12T09:20:48.096362Z\",\n        \"ref\": \"ee448f20e7024cdda29f8ec20aa2ffd0\",\n        \"version\": \"10\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_ratelimit\",\n            \"http_request_firewall_managed\",\n            \"http_request_sbfm\"\n          ],\n          \"products\": [\n            \"zoneLockdown\",\n            \"uaBlock\",\n            \"bic\",\n            \"hot\",\n            \"securityLevel\",\n            \"rateLimit\",\n            \"waf\"\n          ],\n          \"ruleset\": \"current\"\n        },\n        \"description\": \"hiport.caseyyy.site\",\n        \"enabled\": true,\n        \"expression\": \"(http.host wildcard \\\"hiport.caseyyy.site*\\\")\",\n        \"id\": \"66c7987d5edc49c9b5dd2ba362d4d1ba\",\n        \"last_updated\": \"2025-09-18T13:35:01.528894Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"66c7987d5edc49c9b5dd2ba362d4d1ba\",\n        \"version\": \"3\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_ratelimit\",\n            \"http_request_firewall_managed\",\n            \"http_request_sbfm\"\n          ],\n          \"products\": [\n            \"waf\",\n            \"rateLimit\",\n            \"securityLevel\",\n            \"hot\",\n            \"bic\",\n            \"uaBlock\",\n            \"zoneLockdown\"\n          ],\n          \"ruleset\": \"current\"\n        },\n        \"description\": \"white-list\",\n        \"enabled\": true,\n        \"expression\": \"(ip.src in {1.34.61.17 61.62.24.150 202.39.33.231 220.130.223.175 220.130.223.176 35.229.176.92 35.221.237.219 210.63.162.252 218.210.125.252 203.74.185.252})\",\n        \"id\": \"c281980281ac4252889d7aa4d90bb35a\",\n        \"last_updated\": \"2025-09-17T14:18:13.915893Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"c281980281ac4252889d7aa4d90bb35a\",\n        \"version\": \"12\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_ratelimit\",\n            \"http_request_firewall_managed\",\n            \"http_request_sbfm\"\n          ],\n          \"products\": [\n            \"zoneLockdown\",\n            \"uaBlock\",\n            \"bic\",\n            \"hot\",\n            \"securityLevel\",\n            \"rateLimit\",\n            \"waf\"\n          ],\n          \"ruleset\": \"current\"\n        },\n        \"description\": \"logpush_bypass\",\n        \"enabled\": true,\n        \"expression\": \"(cf.bot_management.ja4 in {\\\"t13d1311h2_f57a46bbacb6_e7c285222651\\\"})\",\n        \"id\": \"8f62ace06bcf414f86966789146fe7d0\",\n        \"last_updated\": \"2025-07-28T02:48:23.289864Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"8f62ace06bcf414f86966789146fe7d0\",\n        \"version\": \"2\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_ratelimit\",\n            \"http_request_sbfm\",\n            \"http_request_firewall_managed\"\n          ],\n          \"products\": [\n            \"zoneLockdown\",\n            \"uaBlock\",\n            \"bic\",\n            \"hot\",\n            \"securityLevel\",\n            \"rateLimit\",\n            \"waf\"\n          ],\n          \"ruleset\": \"current\"\n        },\n        \"description\": \"n8n webhook_mcp\",\n        \"enabled\": true,\n        \"expression\": \"(http.request.full_uri wildcard r\\\"https://n8n.twister5.cf/webhook/*\\\") or (http.request.full_uri wildcard r\\\"https://n8n.twister5.cf/mcp/*\\\") or (http.request.full_uri wildcard r\\\"https://n8n.twister5.cf/rest/oauth2-credential/callback\\\")\",\n        \"id\": \"c11dbbe63199484e97b7fd454be47015\",\n        \"last_updated\": \"2025-10-29T06:21:07.506593Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"c11dbbe63199484e97b7fd454be47015\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"France ASN Block\",\n        \"enabled\": true,\n        \"expression\": \"(ip.src.asnum eq 211590) or (ip.src.country eq \\\"FR\\\")\",\n        \"id\": \"dc0f89bb17514dff84aefa2d4b23f865\",\n        \"last_updated\": \"2025-07-24T07:14:12.059162Z\",\n        \"ref\": \"dc0f89bb17514dff84aefa2d4b23f865\",\n        \"version\": \"1\"\n      },\n      {\n        \"action\": \"managed_challenge\",\n        \"description\": \"challenge\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"www.twister5.cf\\\")\",\n        \"id\": \"2bc4b908d3ab469ea063cb7d10cff26a\",\n        \"last_updated\": \"2025-07-09T04:12:04.998264Z\",\n        \"ref\": \"2bc4b908d3ab469ea063cb7d10cff26a\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"managed_challenge\",\n        \"description\": \"nginx.twister5.cf\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"nginx.twister5.cf\\\")\",\n        \"id\": \"bcd7bd74a8e241a09f2289fa43722079\",\n        \"last_updated\": \"2025-07-09T04:12:29.092527Z\",\n        \"ref\": \"bcd7bd74a8e241a09f2289fa43722079\",\n        \"version\": \"7\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"n8n\&graylog allow ip\",\n        \"enabled\": true,\n        \"expression\": \"(http.host in {\\\"n8n.twister5.cf\\\" \\\"graylog.twister5.cf\\\" \\\"aaaa.twister5.cf\\\"} and not ip.src in {202.39.33.231 1.34.61.17 61.62.24.150 220.130.223.175 220.130.223.176})\",\n        \"id\": \"5af3e456b2be458aade71c62d15b89d7\",\n        \"last_updated\": \"2025-05-22T05:09:18.303573Z\",\n        \"ref\": \"5af3e456b2be458aade71c62d15b89d7\",\n        \"version\": \"27\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"Duplicate of ipv6\&n8n test2\",\n        \"enabled\": false,\n        \"expression\": \"(not ip.src in $whitelist_ip and not ip.src in $ipv6 and http.host eq \\\"n8n.twister5.cf\\\")\",\n        \"id\": \"fd26be12dc1948218a9486ceea29863f\",\n        \"last_updated\": \"2025-05-22T05:09:06.547094Z\",\n        \"ref\": \"fd26be12dc1948218a9486ceea29863f\",\n        \"version\": \"12\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"ipv6\&n8n\",\n        \"enabled\": false,\n        \"expression\": \"(not(ip.src in $ipv6 or ip.src in $whitelist_ip) and http.host eq \\\"n8n.twister5.cf\\\")\",\n        \"id\": \"5ea430ccde774207ad3f3992b8519e79\",\n        \"last_updated\": \"2025-05-21T12:19:47.621982Z\",\n        \"ref\": \"5ea430ccde774207ad3f3992b8519e79\",\n        \"version\": \"7\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_ratelimit\",\n            \"http_request_firewall_managed\",\n            \"http_request_sbfm\"\n          ],\n          \"products\": [\n            \"zoneLockdown\",\n            \"uaBlock\",\n            \"bic\",\n            \"hot\",\n            \"securityLevel\",\n            \"rateLimit\",\n            \"waf\"\n          ],\n          \"ruleset\": \"current\"\n        },\n        \"description\": \"cloudflare IP Allow\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"n8n.twister5.cf\\\" and ip.src.asnum in {132892  202623})\",\n        \"id\": \"4361049273774865a331a49d6c3fa727\",\n        \"last_updated\": \"2025-05-20T03:36:48.521439Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"4361049273774865a331a49d6c3fa727\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"upload test\",\n        \"enabled\": true,\n        \"expression\": \"(http.request.full_uri contains \\\"https://nginx.twister5.cf/upload.php\\\" and not ip.src in {1.34.61.17 61.62.24.150})\",\n        \"id\": \"7c2436d509014363bb23d55bcab11532\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"7c2436d509014363bb23d55bcab11532\",\n        \"version\": \"3\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"block upload test _pdf\",\n        \"enabled\": true,\n        \"expression\": \"(http.request.full_uri contains \\\"https://nginx.twister5.cf/upload.php\\\" and any(cf.waf.content_scan.obj_types[*] contains \\\"application/pdf\\\"))\",\n        \"id\": \"b2722f50a507402893170c6823fb67cf\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"b2722f50a507402893170c6823fb67cf\",\n        \"version\": \"7\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_request_firewall_managed\",\n            \"http_request_sbfm\",\n            \"http_ratelimit\"\n          ],\n          \"products\": [\n            \"waf\",\n            \"rateLimit\",\n            \"securityLevel\",\n            \"hot\",\n            \"bic\",\n            \"zoneLockdown\",\n            \"uaBlock\"\n          ],\n          \"ruleset\": \"current\"\n        },\n        \"description\": \"JA4 Bypass\",\n        \"enabled\": true,\n        \"expression\": \"(cf.bot_management.ja4 in {\\\"t13d591000_a33745022dd6_1f22a2ca17c4\\\"})\",\n        \"id\": \"70748e98b8bd4e09a91b454919835719\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"70748e98b8bd4e09a91b454919835719\",\n        \"version\": \"4\"\n      },\n      {\n        \"action\": \"log\",\n        \"description\": \"log (pre-block) deepseek\",\n        \"enabled\": true,\n        \"expression\": \"(\\n  not cf.bot_management.verified_bot\\n  and (\\n    lower(http.request.headers[\\\"user-agent\\\"][0]) contains \\\"deepseek-r1\\\" \\n    or lower(http.request.headers[\\\"user-agent\\\"][0]) contains \\\"deepseek-r1-lite\\\"\\n    or lower(http.request.headers[\\\"user-agent\\\"][0]) contains \\\"deepseek-v2.5\\\"\\n    or lower(http.request.headers[\\\"user-agent\\\"][0]) contains \\\"deepseek-v2.5-1210\\\"\\n    or lower(http.request.headers[\\\"user-agent\\\"][0]) contains \\\"deepseek-v3\\\"\\n    or lower(http.request.headers[\\\"user-agent\\\"][0]) contains \\\"deepseek-chat\\\"\\n    or lower(http.request.headers[\\\"user-agent\\\"][0]) contains \\\"deepseek-reasoner\\\"\\n    or lower(http.request.headers[\\\"user-agent\\\"][0]) contains \\\"deepseek\\\"\\n  )\\n)\\n\",\n        \"id\": \"17cb51638fa24760a5f773c488b674ca\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"17cb51638fa24760a5f773c488b674ca\",\n        \"version\": \"2\"\n      },\n      {\n        \"action\": \"log\",\n        \"description\": \"twister5 www\",\n        \"enabled\": true,\n        \"expression\": \"(http.host contains \\\"www.twister5.cf\\\")\",\n        \"id\": \"ebc04af64a264db99b7e0856aa4d1e17\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"ebc04af64a264db99b7e0856aa4d1e17\",\n        \"version\": \"6\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_ratelimit\",\n            \"http_request_sbfm\",\n            \"http_request_firewall_managed\"\n          ],\n          \"ruleset\": \"current\"\n        },\n        \"description\": \"yuyy\",\n        \"enabled\": false,\n        \"expression\": \"(ip.src in $aa)\",\n        \"id\": \"92a09f708dc94972a5a5dfc2e3f3af7e\",\n        \"last_updated\": \"2025-05-30T03:42:11.486672Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"92a09f708dc94972a5a5dfc2e3f3af7e\",\n        \"version\": \"4\"\n      },\n      {\n        \"action\": \"log\",\n        \"description\": \"no response when not in 80_443 port\",\n        \"enabled\": true,\n        \"expression\": \"(not cf.edge.server_port in {80 443})\",\n        \"id\": \"ce496a93b8544a988d78130d31da3c48\",\n        \"last_updated\": \"2025-09-18T11:54:41.38506Z\",\n        \"ref\": \"ce496a93b8544a988d78130d31da3c48\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_request_firewall_managed\",\n            \"http_ratelimit\",\n            \"http_request_sbfm\"\n          ],\n          \"products\": [\n            \"zoneLockdown\",\n            \"uaBlock\",\n            \"bic\",\n            \"hot\",\n            \"rateLimit\",\n            \"waf\"\n          ],\n          \"ruleset\": \"current\"\n        },\n        \"description\": \"erp\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"erp.twister5.cf\\\")\",\n        \"id\": \"0286392ac6c94fee9ab1ef32c20f2d0f\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"0286392ac6c94fee9ab1ef32c20f2d0f\",\n        \"version\": \"6\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_request_firewall_managed\",\n            \"http_request_sbfm\",\n            \"http_ratelimit\"\n          ],\n          \"ruleset\": \"current\"\n        },\n        \"description\": \"office to_www.twister5.cf_wordpress\",\n        \"enabled\": false,\n        \"expression\": \"(http.host eq \\\"www.twister5.cf\\\" and ip.src eq 202.39.33.231)\",\n        \"id\": \"fbc3060a721e4155ba22529af1d1589f\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"fbc3060a721e4155ba22529af1d1589f\",\n        \"version\": \"8\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"test api2.twister5.cf(API Shield)\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"api2.twister5.cf\\\" and not ip.src in {202.39.33.231 220.130.223.175 61.62.24.150 1.34.61.17})\",\n        \"id\": \"0481fd594cdd4ff8a44b86f8462c42b7\",\n        \"last_updated\": \"2025-08-04T06:28:42.013171Z\",\n        \"ref\": \"0481fd594cdd4ff8a44b86f8462c42b7\",\n        \"version\": \"15\"\n      },\n      {\n        \"action\": \"log\",\n        \"description\": \"jj\",\n        \"enabled\": true,\n        \"expression\": \"(ip.geoip.country in {\\\"CN\\\" \\\"MY\\\" \\\"US\\\"}) and (http.host contains \\n\\\"uushare.cc\\\" or http.host contains \\\"uushare.net\\\" or http.host contains \\\"uushare.cloud\\\" or http.host contains \\\"uushare.org\\\" or  http.host contains \\\"uushare.vip\\\" or http.host contains \\\"uu.vip\\\")  \\n\",\n        \"id\": \"80461dd1af684431bf9d287979116ee4\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"80461dd1af684431bf9d287979116ee4\",\n        \"version\": \"8\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"cf-rayid test block SJC\&HKG Edge\",\n        \"enabled\": false,\n        \"expression\": \"cf.ray_id matches \\\".*(-SJC|-HKG)\\\"\",\n        \"id\": \"26f05eff83c84fb3ae6db5578924e16e\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"26f05eff83c84fb3ae6db5578924e16e\",\n        \"version\": \"17\"\n      },\n      {\n        \"action\": \"managed_challenge\",\n        \"description\": \"Directory Traversal\",\n        \"enabled\": false,\n        \"expression\": \"(http.host eq \\\"nginx.twister5.cf\\\" and http.request.uri.path contains \\\"..\\\")\",\n        \"id\": \"27920a857886451498b03734ecd9c1fe\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"27920a857886451498b03734ecd9c1fe\",\n        \"version\": \"9\"\n      },\n      {\n        \"action\": \"block\",\n        \"action_parameters\": {\n          \"response\": {\n            \"content\": \"hello world!\",\n            \"content_type\": \"text/plain\",\n            \"status_code\": 403\n          }\n        },\n        \"description\": \"test - api2.twister5.cf\",\n        \"enabled\": false,\n        \"expression\": \"(http.host eq \\\"api2.twister5.cf\\\" and http.request.uri.path eq \\\"/api/\\\")\",\n        \"id\": \"4c865bbbd1be49b89a5a8b8f56c1824a\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"4c865bbbd1be49b89a5a8b8f56c1824a\",\n        \"version\": \"34\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"dvwa\",\n        \"enabled\": true,\n        \"expression\": \"(not ip.src in {202.39.33.231 220.130.223.175 1.34.61.17 61.62.24.150} and http.host eq \\\"dvwa.twister5.cf\\\")\",\n        \"id\": \"08b39b4ee33a4a0ca25d46b1caa01f3e\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"08b39b4ee33a4a0ca25d46b1caa01f3e\",\n        \"version\": \"8\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"A04\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"dvwa.twister5.cf\\\" and http.request.uri.path contains \\\"/vulnerabilities/xss_d\\\") and not(( http.request.uri.query contains \\\"default=Spanish\\\") or (http.request.uri.query contains \\\"default=English\\\") or (http.request.uri.query contains \\\"default=German\\\") or (http.request.uri.query eq \\\"\\\"))\",\n        \"id\": \"4187828345c44da79f033d4296d53f72\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"4187828345c44da79f033d4296d53f72\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"A05\",\n        \"enabled\": true,\n        \"expression\": \"(http.request.method in {\\\"HEAD\\\" \\\"OPTIONS\\\"} and http.host eq \\\"dvwa.twister5.cf\\\")\",\n        \"id\": \"d814a6159c03487583f90197c489f8df\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"d814a6159c03487583f90197c489f8df\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"A10-SSRF\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"dvwa.twister5.cf\\\" and http.request.uri.path contains \\\"/vulnerabilities/fi\\\") and (http.request.uri.query contains \\\"page=http\\\")\",\n        \"id\": \"a9f5084747ce43548b9b6fcee1f845e0\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"a9f5084747ce43548b9b6fcee1f845e0\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"header\",\n        \"enabled\": true,\n        \"expression\": \"http.host contains \\\"bde.twister5.cf\\\" and (any(http.request.headers[\\\"aaa\\\"][*] == \\\"123\\\"))\",\n        \"id\": \"ca8c79eea59940108785b954aadca0a3\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"ca8c79eea59940108785b954aadca0a3\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"wordpress\",\n        \"enabled\": true,\n        \"expression\": \"(http.request.full_uri contains \\\"https://wordpress.twister5.cf/wp-login.php\\\" and ip.geoip.country ne \\\"TW\\\")\",\n        \"id\": \"8741bca7d9df4793a70bde10568d39b0\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"8741bca7d9df4793a70bde10568d39b0\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"managed_challenge\",\n        \"description\": \"bot\",\n        \"enabled\": true,\n        \"expression\": \"(cf.bot_management.score lt 99 and not cf.bot_management.verified_bot and http.host eq \\\"dvwa.twister5.cf\\\")\",\n        \"id\": \"5fa7d6578ab84d869fdad3fed7e76f3a\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"5fa7d6578ab84d869fdad3fed7e76f3a\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"managed_challenge\",\n        \"description\": \"特定域名＆bot score\",\n        \"enabled\": false,\n        \"expression\": \"((http.request.uri.path contains \\\"/\\\" or http.request.uri.path contains \\\"/asdf\\\") and cf.bot_management.score lt 20)\",\n        \"id\": \"3ed38d181a78493d87831bebfcb693f7\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"3ed38d181a78493d87831bebfcb693f7\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"Stop R-U-Dead-Yet attack\",\n        \"enabled\": true,\n        \"expression\": \"http.request.method eq \\\"POST\\\" and http.request.uri.path matches \\\"(comment|conversation|event poll)create\\\" and not http.cookie matches \\\"auth_session=[0-9a-zA-Z]{32}-[0-9]{10}-[0-9a-z]{6}\\\"\",\n        \"id\": \"e30fd98bd79d4fe4bf5efb7ad4bfaaee\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"e30fd98bd79d4fe4bf5efb7ad4bfaaee\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"js_challenge\",\n        \"description\": \"ipfstest5.twister5.cf\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"ipfstest5.twister5.cf\\\")\",\n        \"id\": \"f16f65ab1c744f34b5dd9a9fbc357959\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"f16f65ab1c744f34b5dd9a9fbc357959\",\n        \"version\": \"7\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"tw\",\n        \"enabled\": true,\n        \"expression\": \"(http.host in {\\\"api1.twister5.cf\\\"} and not cf.tls_client_auth.cert_verified)\",\n        \"id\": \"6d368e480b6c4ee7aec5e32921ee9225\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"6d368e480b6c4ee7aec5e32921ee9225\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"api2.twister5.cf Regex test\",\n        \"enabled\": false,\n        \"expression\": \"(http.host eq \\\"api2.twister5.cf\\\" and http.request.uri.path matches \\\"^/api/*\\\")\",\n        \"id\": \"5da78aaf2ada49a6a4bd9be166384b5a\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"5da78aaf2ada49a6a4bd9be166384b5a\",\n        \"version\": \"18\"\n      },\n      {\n        \"action\": \"log\",\n        \"description\": \"Country TW\",\n        \"enabled\": true,\n        \"expression\": \"(ip.geoip.country eq \\\"TW\\\")\",\n        \"id\": \"fd71a53654cd400ea385622f3fd4b37d\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"fd71a53654cd400ea385622f3fd4b37d\",\n        \"version\": \"7\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"cflab-3-B\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"app-v1.twister5.cf\\\" and http.request.uri.path eq \\\"/admin\\\" and ip.geoip.country eq \\\"SG\\\" and not http.cookie contains \\\"cf_bypass=true\\\")\",\n        \"id\": \"c60fa527dd8849209709032fc80f308e\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"c60fa527dd8849209709032fc80f308e\",\n        \"version\": \"11\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_ratelimit\",\n            \"http_request_firewall_managed\"\n          ]\n        },\n        \"description\": \"cflab-3-C\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"app-v1.twister5.cf\\\" and http.request.uri.path eq \\\"/admin\\\")\",\n        \"id\": \"a6c9ab0d52e84dadba7a4d829c3a7985\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"a6c9ab0d52e84dadba7a4d829c3a7985\",\n        \"version\": \"8\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"cflab-appv2-block\",\n        \"enabled\": true,\n        \"expression\": \"(not http.cookie contains \\\"cf_bypass=true\\\" and http.host eq \\\"app-v2.twister5.cf\\\" and http.request.uri.path eq \\\"/admin\\\" and ip.geoip.country eq \\\"SG\\\")\",\n        \"id\": \"919d2bd69324436d835b29d0b5d328a2\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"919d2bd69324436d835b29d0b5d328a2\",\n        \"version\": \"8\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_ratelimit\",\n            \"http_request_firewall_managed\"\n          ]\n        },\n        \"description\": \"cflab-appv2-bypass\",\n        \"enabled\": true,\n        \"expression\": \"(http.host eq \\\"app-v2.twister5.cf\\\" and http.request.uri.path eq \\\"/admin\\\")\",\n        \"id\": \"3364314553df48ab9e3afe1a8d168998\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"3364314553df48ab9e3afe1a8d168998\",\n        \"version\": \"5\"\n      },\n      {\n        \"action\": \"managed_challenge\",\n        \"description\": \"Definite Bots \",\n        \"enabled\": true,\n        \"expression\": \"(cf.bot_management.score lt 5 and not cf.bot_management.verified_bot and not cf.bot_management.static_resource and not ip.src in {202.39.33.231 1.34.61.17})\",\n        \"id\": \"94fbd5f5fa574184b51aa2e61008d647\",\n        \"last_updated\": \"2025-07-24T05:48:10.036188Z\",\n        \"ref\": \"94fbd5f5fa574184b51aa2e61008d647\",\n        \"version\": \"12\"\n      },\n      {\n        \"action\": \"managed_challenge\",\n        \"description\": \"Likely Bots [Template]\",\n        \"enabled\": false,\n        \"expression\": \"(cf.bot_management.score gt 2 and cf.bot_management.score lt 30 and not cf.bot_management.verified_bot and not cf.bot_management.static_resource)\",\n        \"id\": \"e1aa155c432745509f346b58be8a964b\",\n        \"last_updated\": \"2025-07-24T05:54:03.570377Z\",\n        \"ref\": \"e1aa155c432745509f346b58be8a964b\",\n        \"version\": \"6\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"block ASN\",\n        \"enabled\": true,\n        \"expression\": \"(ip.src.asnum in {211590})\",\n        \"id\": \"5808ffb0ff864bc3a9c261af6153811e\",\n        \"last_updated\": \"2025-07-24T05:52:41.111515Z\",\n        \"ref\": \"5808ffb0ff864bc3a9c261af6153811e\",\n        \"version\": \"4\"\n      },\n      {\n        \"action\": \"block\",\n        \"action_parameters\": {\n          \"response\": {\n            \"content\": \"you are block\",\n            \"content_type\": \"text/html\",\n            \"status_code\": 403\n          }\n        },\n        \"description\": \"mTLS-enforced authentication [Template]\",\n        \"enabled\": true,\n        \"expression\": \"(not cf.tls_client_auth.cert_verified and http.host eq \\\"mtls2.twister5.cf\\\")\",\n        \"id\": \"50685755d20f49f294efe6f871e81ec3\",\n        \"last_updated\": \"2025-09-09T03:16:34.780002Z\",\n        \"ref\": \"50685755d20f49f294efe6f871e81ec3\",\n        \"version\": \"18\"\n      },\n      {\n        \"action\": \"managed_challenge\",\n        \"description\": \"Fallthrough rule_1_managed_challange（當通過api的subdomain時,所有api的request都做挑戰）\",\n        \"enabled\": true,\n        \"expression\": \"(cf.api_gateway.fallthrough_detected and http.host in {\\\"carbon-rights-backend-334c8980a6b5.herokuapp.com\\\" \\\"cubic-pigweed-5x9816ztzesglix2i5a5a5ti.herokudns.com\\\" \\\"silhouetted-suchomimus-xi64i8uqe0p5eodas20lcnfh.herokudns.com\\\" \\\"apiv5.twister5.cf\\\" \\\"api.para-universe-energy-exchange-station.com\\\"})\",\n        \"id\": \"8ebd01b029af41cda2bd497188a2cdcc\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"8ebd01b029af41cda2bd497188a2cdcc\",\n        \"version\": \"13\"\n      },\n      {\n        \"action\": \"challenge\",\n        \"description\": \"Fallthrough rule - Challenge(當通過api的subdomain時，api路徑包含admin以及profile/picture等字眼的path做挑戰)\",\n        \"enabled\": true,\n        \"expression\": \"(cf.api_gateway.fallthrough_detected and http.host in {\\\"carbon-rights-backend-334c8980a6b5.herokuapp.com\\\" \\\"api.para-universe-energy-exchange-station.com\\\" \\\"apiv5.twister5.cf\\\" \\\"silhouetted-suchomimus-xi64i8uqe0p5eodas20lcnfh.herokudns.com\\\" \\\"cubic-pigweed-5x9816ztzesglix2i5a5a5ti.herokudns.com\\\"} and http.request.uri contains \\\"admin\\\") or (http.request.uri.path in {\\\"/api/account/change-password\\\"}) or (http.request.uri contains \\\"profile/picture\\\") or (http.request.uri contains \\\"/profile\\\")\",\n        \"id\": \"590828a80f564f59b03d528667c19d9b\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"590828a80f564f59b03d528667c19d9b\",\n        \"version\": \"12\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"Fallthrough rule(當通過api的subdomain時，且query string 包含高敏感字眼：如db,database,id,password等)\",\n        \"enabled\": true,\n        \"expression\": \"(cf.api_gateway.fallthrough_detected and http.host in {\\\"apiv5.twister5.cf\\\"}) and ((http.request.uri.query contains \\\"admin\\\") or (http.request.uri.query contains \\\"database\\\") or (http.request.uri.query contains \\\"db\\\") or (http.request.uri.query contains \\\"password\\\") or (http.request.uri.query contains \\\"id\\\") or (http.request.uri.query contains \\\"account\\\"))\",\n        \"id\": \"afab0f2badf643568a831544eb9246b7\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"afab0f2badf643568a831544eb9246b7\",\n        \"version\": \"10\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"block除了www以外的ipv6\",\n        \"enabled\": false,\n        \"expression\": \"(http.host ne \\\"www.example.com\\\" and ip.src in {2000::/3})\\n\",\n        \"id\": \"4b51bec340a44fb6854ea4626d980766\",\n        \"last_updated\": \"2025-05-08T09:13:26.137185Z\",\n        \"ref\": \"4b51bec340a44fb6854ea4626d980766\",\n        \"version\": \"3\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"black_ip_api.twister5.cf\",\n        \"enabled\": true,\n        \"expression\": \"(ip.src in {2.2.2.2} and http.host eq \\\"api.twister5.cf\\\")\",\n        \"id\": \"7f69e04390f045d2997b0401b3f8c4b8\",\n        \"last_updated\": \"2025-12-17T08:16:14.472843Z\",\n        \"ref\": \"7f69e04390f045d2997b0401b3f8c4b8\",\n        \"version\": \"3\"\n      },\n      {\n        \"action\": \"skip\",\n        \"action_parameters\": {\n          \"phases\": [\n            \"http_request_firewall_managed\",\n            \"http_ratelimit\",\n            \"http_request_sbfm\"\n          ]\n        },\n        \"description\": \"jeff-white-list\",\n        \"enabled\": true,\n        \"expression\": \"(ip.src in {3.3.3.3})\",\n        \"id\": \"607bd20e9cad4efdb2c42f0783976bf8\",\n        \"last_updated\": \"2025-12-22T08:34:22.31652Z\",\n        \"logging\": {\n          \"enabled\": true\n        },\n        \"ref\": \"607bd20e9cad4efdb2c42f0783976bf8\",\n        \"version\": \"46\"\n      },\n      {\n        \"action\": \"block\",\n        \"description\": \"jeff-black-list\",\n        \"enabled\": true,\n        \"expression\": \"(ip.src in {2.2.2.2 202.39.33.231 74.7.227.168} and http.host eq \\\"api.twister5.cf\\\")\",\n        \"id\": \"a3ea77135c3b4ded9ffc4c0c50b39f99\",\n        \"last_updated\": \"2025-12-23T01:43:28.034763Z\",\n        \"ref\": \"a3ea77135c3b4ded9ffc4c0c50b39f99\",\n        \"version\": \"41\"\n      }\n    ],\n    \"source\": \"firewall_custom\",\n    \"version\": \"2244\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n",
            "error_message": null
        },
        "error": null,
        "elapsed_time": 2.219788,
        "total_tokens": 0,
        "total_steps": 9,
        "created_at": 1766454206,
        "finished_at": 1766454208
    }
}
```

### Example 如果內文沒有半筆 IPV4 資料 ERROR Response Message
```json
{
    "task_id": "d6e0c46a-d19b-4db4-a68c-60c15450b7e2",
    "workflow_run_id": "d9439f12-a7aa-4429-b55d-bf0b1fcc3743",
    "data": {
        "id": "d9439f12-a7aa-4429-b55d-bf0b1fcc3743",
        "workflow_id": "422c9011-3f7c-421c-bd98-42315f3209af",
        "status": "succeeded",
        "outputs": {
            "otherError": 500,
            "errorMessage": "No IP information"
        },
        "error": null,
        "elapsed_time": 0.15524,
        "total_tokens": 0,
        "total_steps": 4,
        "created_at": 1766454197,
        "finished_at": 1766454198
    }
}
```

### Example Invalid Param ERROR Response Message
```json
{
    "code": "invalid_param",
    "message": "IPlist is required in input form",
    "status": 400
}
```

### Example Invalid Param ERROR Response Message
```json
{
    "code": "invalid_param",
    "message": "Arg user must be provided.",
    "status": 400
}
```