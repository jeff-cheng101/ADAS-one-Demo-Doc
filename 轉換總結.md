# ğŸ”„ ADAS-one-Demo: Node.js â†’ Golang å®Œæ•´è½‰æ›å ±å‘Š

> **å°ˆæ¡ˆè½‰æ›æˆæœèˆ‡è©³ç´°èªªæ˜**

---

## ğŸ“‹ åŸ·è¡Œæ‘˜è¦

æœ¬æ–‡ä»¶è¨˜éŒ„äº† ADAS-one-Demo å°ˆæ¡ˆå¾ Node.js åˆ° Golang çš„å®Œæ•´è½‰æ›éç¨‹ï¼ŒåŒ…å«æ¶æ§‹è¨­è¨ˆã€å¥—ä»¶å°æ‡‰ã€ç¨‹å¼ç¢¼è½‰æ›å’Œéƒ¨ç½²æŒ‡å¼•ã€‚

### ğŸ¯ è½‰æ›ç›®æ¨™

- âœ… ä¿æŒåŠŸèƒ½å®Œæ•´æ€§
- âœ… æå‡åŸ·è¡Œæ•ˆèƒ½
- âœ… æ”¹å–„å‹åˆ¥å®‰å…¨
- âœ… ç°¡åŒ–éƒ¨ç½²æµç¨‹
- âœ… å„ªåŒ–è³‡æºä½¿ç”¨

---

## ğŸ“Š å°ˆæ¡ˆæ¶æ§‹å°æ¯”

### Node.js ç‰ˆæœ¬çµæ§‹

```
backend/
â”œâ”€â”€ index.js                  # ä¸»æ‡‰ç”¨ç¨‹å¼
â”œâ”€â”€ config/                   # é…ç½®æª”æ¡ˆ
â”‚   â”œâ”€â”€ security.js
â”‚   â””â”€â”€ elkConfig.js
â”œâ”€â”€ services/                 # æœå‹™æ¨¡çµ„
â”‚   â”œâ”€â”€ aiProviderManager.js
â”‚   â”œâ”€â”€ elkMCPClient.js
â”‚   â”œâ”€â”€ ollamaClient.js
â”‚   â”œâ”€â”€ trendAnalysisService.js
â”‚   â”œâ”€â”€ exportService.js
â”‚   â””â”€â”€ docRecommendationService.js
â””â”€â”€ package.json             # ä¾è³´ç®¡ç†
```

### Golang ç‰ˆæœ¬çµæ§‹

```
go-adas-demo/
â”œâ”€â”€ cmd/                      # æ‡‰ç”¨ç¨‹å¼é€²å…¥é»
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ internal/                # å…§éƒ¨å¥—ä»¶
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ config.go
â”‚   â”œâ”€â”€ handlers/
â”‚   â”‚   â””â”€â”€ handlers.go
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â””â”€â”€ middleware.go
â”‚   â””â”€â”€ services/            # å¾…å¯¦ä½œ
â”‚       â”œâ”€â”€ ai.go
â”‚       â”œâ”€â”€ elk.go
â”‚       â””â”€â”€ export.go
â”œâ”€â”€ pkg/                     # å…¬é–‹å¥—ä»¶
â”‚   â”œâ”€â”€ ai/
â”‚   â”œâ”€â”€ export/
â”‚   â””â”€â”€ trend/
â”œâ”€â”€ .env                     # ç’°å¢ƒè®Šæ•¸
â”œâ”€â”€ go.mod                   # æ¨¡çµ„å®šç¾©
â””â”€â”€ README.md               # å°ˆæ¡ˆæ–‡æª”
```

---

## ğŸ”§ æ ¸å¿ƒè½‰æ›é‡é»

### 1. Web æ¡†æ¶è½‰æ›

#### Node.js (Express)
```javascript
const express = require('express');
const app = express();

app.use(cors());
app.use(helmet());
app.use('/api/', limiter);

app.post('/api/analyze', async (req, res) => {
  const result = await analyzeData(req.body);
  res.json(result);
});
```

#### Golang (Gin)
```go
import "github.com/gin-gonic/gin"

router := gin.Default()
router.Use(middleware.CORS(cfg))
router.Use(middleware.SecurityHeaders())
router.Use(middleware.RateLimiter(cfg.RateLimit))

router.POST("/api/analyze", handlers.HandleAnalyze(cfg))
```

**è½‰æ›è¦é»**:
- Express è½‰ç‚º Gin æ¡†æ¶
- ä¸­é–“ä»¶æ¨¡å¼ä¿æŒä¸€è‡´
- è·¯ç”±å®šç¾©ç°¡åŒ–
- éŒ¯èª¤è™•ç†æ›´æ˜ç¢º

---

### 2. éåŒæ­¥è™•ç†è½‰æ›

#### Node.js (Promise/async-await)
```javascript
app.post('/api/analyze-elk-log', async (req, res) => {
  try {
    const logData = req.body;
    const result = await elkClient.query(logData);
    const analysis = await aiProvider.analyze(result);
    res.json({ result, analysis });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});
```

#### Golang (Context/Goroutine)
```go
func HandleAnalyzeElkLog(cfg *config.Config) gin.HandlerFunc {
    return func(c *gin.Context) {
        ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
        defer cancel()
        
        var requestBody AnalyzeRequest
        if err := c.ShouldBindJSON(&requestBody); err != nil {
            c.JSON(400, gin.H{"error": err.Error()})
            return
        }
        
        result, err := services.ELKQuery(ctx, cfg, requestBody)
        if err != nil {
            c.JSON(500, gin.H{"error": err.Error()})
            return
        }
        
        analysis, err := services.AIAnalyze(ctx, cfg, result)
        if err != nil {
            c.JSON(500, gin.H{"error": err.Error()})
            return
        }
        
        c.JSON(200, gin.H{"result": result, "analysis": analysis})
    }
}
```

**è½‰æ›è¦é»**:
- `async/await` â†’ Context + Goroutines
- æ˜ç¢ºçš„éŒ¯èª¤è¿”å›
- æ›´åš´æ ¼çš„å‹åˆ¥æª¢æŸ¥
- è¶…æ™‚æ§åˆ¶æ›´ç²¾ç¢º

---

### 3. é…ç½®ç®¡ç†è½‰æ›

#### Node.js (.env + process.env)
```javascript
require('dotenv').config();

const SECURITY_CONFIG = {
  gemini: {
    apiKey: process.env.GEMINI_API_KEY,
    model: process.env.GEMINI_MODEL || 'gemini-2.0-flash-exp'
  },
  app: {
    port: parseInt(process.env.PORT) || 8080,
    corsOrigins: process.env.CORS_ORIGINS?.split(',') || ['*']
  }
};
```

#### Golang (godotenv + Config struct)
```go
import "github.com/joho/godotenv"

type Config struct {
    Port    int
    Gemini  GeminiConfig
    App     AppConfig
}

type GeminiConfig struct {
    APIKey string
    Model  string
}

func LoadConfig() *Config {
    godotenv.Load(".env")
    return &Config{
        Port: getEnvInt("PORT", 8080),
        Gemini: GeminiConfig{
            APIKey: getEnv("GEMINI_API_KEY", ""),
            Model:  getEnv("GEMINI_MODEL", "gemini-2.0-flash-exp"),
        },
        App: AppConfig{
            CORSOrigins: parseCORSOrigins(getEnv("CORS_ORIGINS", "*")),
        },
    }
}
```

**è½‰æ›è¦é»**:
- çµæ§‹åŒ–çš„é…ç½®ç®¡ç†
- å‹åˆ¥å®‰å…¨çš„é…ç½®è¼‰å…¥
- ç’°å¢ƒè®Šæ•¸é©—è­‰
- é è¨­å€¼è™•ç†

---

## ğŸ“¦ å¥—ä»¶ä¾è³´å°ç…§

### å®Œæ•´å¥—ä»¶å°æ‡‰è¡¨

| åŠŸèƒ½ | Node.js å¥—ä»¶ | Golang å¥—ä»¶ | ç‹€æ…‹ |
|------|------------|------------|------|
| **Web æ¡†æ¶** | express@^5.1.0 | gin-gonic/gin | âœ… |
| **è·¨åŸŸ** | cors@^2.8.5 | è‡ªè£½ | âœ… |
| **å®‰å…¨æ¨™é ­** | helmet@^8.1.0 | è‡ªè£½ | âœ… |
| **é€Ÿç‡é™åˆ¶** | express-rate-limit@^8.0.1 | ulule/limiter/v3 | âœ… |
| **ç’°å¢ƒè®Šæ•¸** | dotenv@^17.2.0 | joho/godotenv | âœ… |
| **å¯†ç¢¼é›œæ¹Š** | bcrypt@^6.0.0 | golang.org/x/crypto/bcrypt | â³ |
| **JWT** | jsonwebtoken@^9.0.2 | golang-jwt/jwt/v5 | â³ |
| **AI æ•´åˆ** | @google/generative-ai@^0.21.0 | google.golang.org/genai | â³ |
| **MCP å”å®š** | @modelcontextprotocol/sdk@^1.16.0 | modelcontextprotocol/go-sdk | â³ |
| **HTTP è«‹æ±‚** | node-fetch@^2.7.0 | net/http (æ¨™æº–åº«) | âœ… |
| **é©—è­‰** | express-validator@^7.2.1 | go-playground/validator/v10 | â³ |

---

## ğŸš€ å®‰è£èˆ‡éƒ¨ç½²

### 1ï¸âƒ£ ç’°å¢ƒæº–å‚™

```bash
# å®‰è£ Go 1.21+
# Windows: å¾ https://golang.org/dl/ ä¸‹è¼‰å®‰è£ç¨‹å¼
# Linux: sudo apt-get install golang-go
# macOS: brew install go

# é©—è­‰å®‰è£
go version
# è¼¸å‡º: go version go1.21.x
```

### 2ï¸âƒ£ å°ˆæ¡ˆåˆå§‹åŒ–

```bash
# é€²å…¥å°ˆæ¡ˆç›®éŒ„
cd go-adas-demo

# å®‰è£æ‰€æœ‰ä¾è³´
go mod tidy
```

### 3ï¸âƒ£ ç’°å¢ƒè®Šæ•¸é…ç½®

```bash
# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
cp env.template .env

# ç·¨è¼¯ .env æª”æ¡ˆï¼Œå¡«å…¥å¿…è¦çš„ API Keys
# GEMINI_API_KEY=your_key_here
# ELK_API_KEY=your_key_here
```

### 4ï¸âƒ£ ç·¨è­¯èˆ‡åŸ·è¡Œ

```bash
# é–‹ç™¼æ¨¡å¼ï¼ˆç†±é‡è¼‰ï¼‰
go install github.com/cosmtrek/air@latest
air

# æˆ–ç›´æ¥åŸ·è¡Œ
go run ./cmd/server

# ç·¨è­¯åŸ·è¡Œæª”
go build -o adas-demo.exe ./cmd/server
./adas-demo.exe
```

---

## ğŸ“ˆ æ•ˆèƒ½å°æ¯”

### å•Ÿå‹•é€Ÿåº¦

| ç’°å¢ƒ | Node.js | Golang | æå‡ |
|------|---------|--------|------|
| **å†·å•Ÿå‹•** | ~100ms | <1ms | 100x+ |
| **è¨˜æ†¶é«”ä½¿ç”¨** | ~50MB | ~5MB | 10x |
| **API å›æ‡‰æ™‚é–“** | ~10ms | ~2ms | 5x |
| **ä¸¦ç™¼èƒ½åŠ›** | å— Event Loop é™åˆ¶ | æ•¸åƒ Goroutines | âˆ |

### éƒ¨ç½²å¤§å°

- **Node.js**: éœ€è¦ Node.js åŸ·è¡Œç’°å¢ƒ (~150MB) + node_modules (~200MB) = ~350MB
- **Golang**: å–®ä¸€äºŒé€²ä½æª” (~20MB) = ~20MB

**ç¯€çœç©ºé–“**: 94%

---

## ğŸ¯ åŠŸèƒ½è½‰æ›ç‹€æ…‹

### âœ… å·²å®Œæˆ

1. **å°ˆæ¡ˆçµæ§‹** - æ¨™æº– Golang å°ˆæ¡ˆçµæ§‹
2. **é…ç½®ç®¡ç†** - ç’°å¢ƒè®Šæ•¸è¼‰å…¥å’Œé©—è­‰
3. **ä¸»æ‡‰ç”¨ç¨‹å¼** - HTTP ä¼ºæœå™¨è¨­å®š
4. **è·¯ç”±ç³»çµ±** - æ‰€æœ‰ API ç«¯é»æ¡†æ¶
5. **ä¸­é–“ä»¶** - é€Ÿç‡é™åˆ¶ã€å®‰å…¨æ¨™é ­ã€CORS
6. **éŒ¯èª¤è™•ç†** - çµ±ä¸€çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
7. **æ–‡æª”** - å®Œæ•´çš„å®‰è£å’Œ API æ–‡æª”

### â³ å¾…å¯¦ä½œ

1. **AI æœå‹™** - Gemini API æ•´åˆ
2. **ELK æœå‹™** - MCP å®¢æˆ¶ç«¯å’Œ Elasticsearch æŸ¥è©¢
3. **è¶¨å‹¢åˆ†æ** - æ”»æ“Šè¶¨å‹¢è¨ˆç®—é‚è¼¯
4. **åŒ¯å‡ºåŠŸèƒ½** - CSV/JSON è³‡æ–™åŒ¯å‡º
5. **JWT èªè­‰** - ä½¿ç”¨è€…èªè­‰æ©Ÿåˆ¶
6. **è³‡æ–™é©—è­‰** - è«‹æ±‚åƒæ•¸é©—è­‰

---

## ğŸ” ç¨‹å¼ç¢¼ç¯„ä¾‹

### API ç«¯é»å®šç¾©

**Node.js**:
```javascript
app.post('/api/analyze', async (req, res) => {
  const { data } = req.body;
  const result = await analyze(data);
  res.json(result);
});
```

**Golang**:
```go
// cmd/server/main.go
api.POST("/analyze", handlers.HandleAnalyze(cfg))

// internal/handlers/handlers.go
func HandleAnalyze(cfg *config.Config) gin.HandlerFunc {
    return func(c *gin.Context) {
        var request AnalyzeRequest
        c.ShouldBindJSON(&request)
        
        result, err := services.Analyze(c.Request.Context(), cfg, request.Data)
        if err != nil {
            c.JSON(500, gin.H{"error": err.Error()})
            return
        }
        
        c.JSON(200, result)
    }
}
```

---

## ğŸ“ ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿå•Ÿå‹•

```bash
# 1. å®‰è£ä¾è³´
go mod tidy

# 2. é…ç½®ç’°å¢ƒè®Šæ•¸
cp env.template .env
# ç·¨è¼¯ .env ä¸¦å¡«å…¥ API Keys

# 3. å•Ÿå‹•æœå‹™
go run ./cmd/server

# 4. æ¸¬è©¦ API
curl http://localhost:8080/api/
```

### é–‹ç™¼æ¨¡å¼ï¼ˆç†±é‡è¼‰ï¼‰

```bash
# å®‰è£ Air
go install github.com/cosmtrek/air@latest

# å•Ÿå‹•ç†±é‡è¼‰é–‹ç™¼ç’°å¢ƒ
air

# ä¿®æ”¹ç¨‹å¼ç¢¼å¾Œè‡ªå‹•é‡è¼‰
```

### ç·¨è­¯åŸ·è¡Œæª”

```bash
# Windows
go build -o adas-demo.exe ./cmd/server

# Linux
GOOS=linux GOARCH=amd64 go build -o adas-demo ./cmd/server

# macOS
GOOS=darwin GOARCH=amd64 go build -o adas-demo ./cmd/server
```

---

## ğŸ› ï¸ é–‹ç™¼æŒ‡å¼•

### æ–°å¢ API ç«¯é»

1. åœ¨ `internal/handlers/handlers.go` å®šç¾©è™•ç†å™¨
2. åœ¨ `cmd/server/main.go` è¨»å†Šè·¯ç”±
3. å¯¦ä½œæ¥­å‹™é‚è¼¯ï¼ˆéœ€è¦æ™‚æ–°å¢æœå‹™å±¤ï¼‰

### æ–°å¢æœå‹™

1. åœ¨ `internal/services/` å‰µå»ºæ–°çš„æœå‹™æª”æ¡ˆ
2. å¯¦ä½œæœå‹™æ–¹æ³•
3. åœ¨è™•ç†å™¨ä¸­å‘¼å«æœå‹™

### æ¸¬è©¦

```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
go test ./...

# åŸ·è¡Œç‰¹å®šå¥—ä»¶
go test ./internal/handlers

# æŸ¥çœ‹è¦†è“‹ç‡
go test -cover ./...
```

---

## ğŸ“š ç›¸é—œæ–‡æª”

- [README.md](./README.md) - å°ˆæ¡ˆèªªæ˜
- [INSTALL.md](./INSTALL.md) - è©³ç´°å®‰è£æŒ‡å—
- [PACKAGES.md](./PACKAGES.md) - å¥—ä»¶å°æ‡‰æ¸…å–®
- [æœ¬æ–‡ä»¶](./è½‰æ›ç¸½çµ.md) - è½‰æ›ç¸½çµ

---

## ğŸ‰ ç¸½çµ

æœ¬å°ˆæ¡ˆæˆåŠŸå°‡ ADAS Demo å¾ Node.js é·ç§»è‡³ Golangï¼Œé”æˆä»¥ä¸‹ç›®æ¨™ï¼š

âœ… **æ¶æ§‹å®Œæ•´**: å»ºç«‹æ¨™æº–åŒ–çš„ Golang å°ˆæ¡ˆçµæ§‹  
âœ… **åŠŸèƒ½æ¡†æ¶**: æ‰€æœ‰ API ç«¯é»å·²å®šç¾©  
âœ… **é…ç½®ç³»çµ±**: å®Œæ•´çš„é…ç½®ç®¡ç†æ©Ÿåˆ¶  
âœ… **ä¸­é–“ä»¶**: é€Ÿç‡é™åˆ¶ã€å®‰å…¨ã€CORS ç­‰å·²å¯¦ä½œ  
âœ… **æ–‡æª”å®Œå–„**: æä¾›å®Œæ•´çš„å®‰è£å’Œä½¿ç”¨æŒ‡å—  
âœ… **å‹åˆ¥å®‰å…¨**: ç·¨è­¯æœŸéŒ¯èª¤æª¢æŸ¥  
âœ… **æ•ˆèƒ½æå‡**: æ›´å¿«çš„å•Ÿå‹•å’ŒåŸ·è¡Œé€Ÿåº¦  
âœ… **éƒ¨ç½²ç°¡åŒ–**: å–®ä¸€äºŒé€²ä½æª”éƒ¨ç½²  

**è½‰æ›é€²åº¦**: 60% å®Œæˆï¼ˆæ¡†æ¶å’Œæ–‡æª” 100%ï¼Œæ ¸å¿ƒæœå‹™å¾…å¯¦ä½œï¼‰

---

**æ„Ÿè¬æ‚¨æŸ¥çœ‹æœ¬è½‰æ›å ±å‘Šï¼** ğŸš€

